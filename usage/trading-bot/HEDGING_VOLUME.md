# 跨所对冲刷量(挂单)策略使用指南

[← 返回主页](../../README.md) | [← 返回交易机器人](./README.md)

挂单对冲刷量策略是一种低风险的量化交易策略，通过在两个交易所之间进行对冲操作来赚取交易量奖励，目前支持Backpack交易所挂单，Lighter交易所吃单对冲刷量操作。

## 🎯 核心功能

### 自动化交易执行

- **双交易所对冲**：在Maker交易所挂单，成交后立即在Taker交易所对冲
- **智能订单管理**：自动挂单、撤单、成交监控
- **风险控制**：内置止损机制，自动平仓保护
- **实时监控**：WebSocket订阅，毫秒级响应

### 交易所支持

- **Maker交易所**：Backpack（背包交易所）
- **Taker交易所**：Lighter（轻量级DEX）
- **交易对**：ETH_USDC_PERP 永续合约

### 统计与监控

- **实时盈亏统计**：每轮交易盈亏实时更新
- **成交量统计**：分别统计Maker和Taker成交额
- **成功率监控**：交易成功率实时计算
- **日志记录**：详细的操作日志和错误追踪

## 📋 策略逻辑

### 交易流程

1. **开仓对冲**：在Backpack挂买单，成交后立即在Lighter做空同等数量进行对冲锁定价格
2. **持仓等待**：保持对冲仓位30秒，等待市场波动稳定
3. **平仓获利**：在Backpack挂卖单平仓，成交后立即在Lighter买入平仓，完成整个对冲循环
4. **结算统计**：自动计算本轮交易的盈亏、手续费和总成交量，为下一轮交易提供数据参考

### 对冲原理

- **价格锁定**：通过对冲消除价格波动风险
- **交易量奖励**：获取交易所的积分奖励

## ⚙️ 参数配置

### 基础参数

| 参数名称       | 默认值     | 说明                   | 建议范围       |
| -------------- | ---------- | ---------------------- | -------------- |
| **单笔交易量** | 0.005 ETH  | 每次交易的ETH数量      | 0.001-0.01 ETH |
| **交易轮数**   | 10轮       | 总共执行的交易轮数     | 5-50轮         |
| **持仓时间**   | 30秒       | 开仓后的持仓等待时间   | 10-60秒        |
| **订单超时**   | 60秒       | 订单未成交的超时时间   | 30-120秒       |
| **最大重试**   | 5次        | 订单失败后的重试次数   | 3-10次         |
| **最大损失**   | 10.00 USDC | 触发止损的最大损失金额 | 0.01-1000 USDC |

### 手续费设置

| 交易所       | 类型  | 费率  | 说明                   |
| ------------ | ----- | ----- | ---------------------- |
| **Backpack** | Maker | 0.02% | 挂单手续费             |
| **Lighter**  | Taker | 0%    | 吃单手续费（部分账户） |

> ⚠️ 注意：Backpack的手续费根据账户等级可能有所不同

## 🚀 使用步骤

### 1. 账户准备

#### Backpack账户

1. 注册并完成KYC验证
2. 生成API密钥（需要交易权限） 链接：https://backpack.exchange/portfolio/settings/api-keys
3. 充值USDC作为保证金（建议最少30 USDC）

#### Lighter账户

1. 获取账户Index（通过查询功能）
2. 生成API私钥  链接：https://app.lighter.xyz/apikeys
3. 充值USDC作为保证金（建议最少30 USDC）

### 2. 配置交易账户

1. 点击**添加账户**按钮
2. 填写账户信息：
   - 账户名称（自定义）
   - 选择交易所类型
   - 输入API密钥/私钥
   - 对于Lighter，输入Account Index

### 3. 设置策略参数

1. 在策略配置区域设置：
   - 单笔交易量（根据资金量设置）
   - 交易轮数（建议先小量测试）
   - 持仓时间（根据市场活跃度调整）

### 4. 启动策略

1. 确认所有参数设置正确
2. 点击**启动策略**按钮
3. 监控运行状态和日志

### 5. 监控与停止

- **实时监控**：查看交易日志和统计数据
- **手动停止**：随时点击停止按钮终止策略
- **自动停止**：完成设定轮数后自动停止

## 💡 最佳实践

### 资金管理

- **小额测试**：首次使用建议0.005 ETH测试
- **逐步加量**：测试稳定后再增加交易量
- **保证金充足**：确保两边都有足够的保证金

### 参数优化

- **市场活跃时段**：选择流动性好的时段运行
- **动态调整**：根据成交情况调整参数
- **手续费考虑**：计算实际手续费成本

### 风险控制

- **设置止损**：合理设置最大损失限制（建议设置为总资金的1-5%）
- **监控异常**：及时处理异常订单
- **分散风险**：不要把所有资金用于单一策略
- **止损机制**：当累计损失达到设定的最大损失金额时，策略会自动平仓并停止

## ⚠️ 风险提示

### 市场风险

- **流动性风险**：市场流动性不足可能导致无法及时成交
- **价格风险**：极端行情下可能出现滑点损失
- **系统风险**：交易所维护或故障可能影响策略执行

### 技术风险

- **网络延迟**：网络问题可能导致对冲不及时
- **API限制**：频繁请求可能触发限流
- **程序故障**：软件bug可能导致异常交易

### 操作风险

- **参数设置**：错误的参数可能导致亏损
- **账户安全**：API密钥泄露风险
- **资金管理**：过度杠杆可能导致爆仓

## ❓ 常见问题

### Q：为什么Maker订单一直不成交？

**A：** 可能原因：

1. 挂单价格偏离市场价太远
2. 市场流动性不足
3. 订单金额太大
   建议：调整为更接近市场价，或减少单笔交易量

### Q：Taker对冲失败怎么办？

**A：** 系统会自动重试对冲，如果多次失败会：

1. 尝试使用市价单强制成交
2. 记录错误并继续下一轮
3. 最终统计会显示失败的交易

### Q：如何查看Lighter的Account Index？

**A：** 使用内置的查询功能：

1. 点击"查询Account Index"
2. 输入钱包地址
3. 系统会返回所有关联的账户索引

### Q：手续费如何计算？

**A：** 

- Backpack：交易额 × 0.02%（Maker费率）
- Lighter：根据账户等级，可能为0或0.03%
- 总成本 = 开仓手续费 + 平仓手续费

### Q：策略适合什么市场环境？

**A：** 

- **适合**：震荡市、流动性充足、价差稳定
- **不适合**：单边急涨急跌、流动性枯竭
- **最佳时段**：美股交易时段，市场活跃

### Q：如何提高成功率？

**A：** 

1. 选择流动性好的时段
2. 适当减小单笔交易量
3. 增加订单超时时间
4. 使用稳定的网络连接

### Q：出现亏损怎么办？

**A：** 

1. 立即停止策略
2. 检查交易日志找出原因
3. 调整参数后小额测试
4. 确认稳定后再正常运行

## 📊 收益分析

### 收益来源

1. **交易量奖励**：交易所的返佣或奖励
2. **手续费差价**：两个交易所的费率差
3. **市场机会**：偶尔的套利机会

### 成本构成

1. **交易手续费**：主要成本
2. **资金成本**：保证金占用
3. **滑点损失**：市场波动造成

### 收益计算示例

```
假设：
- 单笔交易量：0.01 ETH
- ETH价格：$3000
- 交易20轮

成交额 = 0.01 × 3000 × 20 × 2（开平仓）= $1200
手续费 = 1200 × 0.02% = $0.24
如果有0.01%的返佣 = 1200 × 0.01% = $0.12
净亏损 = -$0.12（需要其他奖励覆盖）
```

## 🔧 技术支持

### 问题排查步骤

1. 查看详细日志，定位错误信息
2. 检查网络连接和API配置
3. 确认账户余额和权限
4. 参考错误代码对照表

### 联系方式

- **问题反馈**：群内@2号牛马在线解答